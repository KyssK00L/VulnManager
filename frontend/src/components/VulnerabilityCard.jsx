import { Shield, ExternalLink } from 'lucide-react'

const levelColors = {
  Critical: 'badge-critical',
  High: 'badge-high',
  Medium: 'badge-medium',
  Low: 'badge-low',
  Informational: 'badge-info',
}

export default function VulnerabilityCard({ vulnerability }) {
  return (
    <div className="card p-6 transition-shadow hover:shadow-md">
      <div className="mb-3 flex items-start justify-between gap-2">
        <h3 className="flex-1 text-lg font-semibold text-gray-900">
          {vulnerability.name}
        </h3>
        <span className={`badge ${levelColors[vulnerability.level]}`}>
          {vulnerability.level}
        </span>
      </div>

      <div className="mb-4 space-y-2 text-sm text-gray-600">
        <div className="flex items-center gap-2">
          <Shield className="h-4 w-4 flex-shrink-0 text-gray-400" />
          <span>{vulnerability.protocol_interface}</span>
        </div>
        {vulnerability.cvss_score && (
          <div className="flex items-center gap-2">
            <span className="font-medium">CVSS:</span>
            <span className="rounded bg-gray-100 px-2 py-0.5 font-mono text-xs">
              {vulnerability.cvss_score.toFixed(1)}
            </span>
          </div>
        )}
      </div>

      <p className="mb-4 line-clamp-3 text-sm text-gray-700">
        {vulnerability.description}
      </p>

      <div className="flex items-center justify-between border-t border-gray-100 pt-4">
        <span className="text-xs text-gray-500">
          Updated {new Date(vulnerability.updated_at).toLocaleDateString()}
        </span>
        <button className="btn-ghost p-2 text-sm">
          <ExternalLink className="h-4 w-4" />
        </button>
      </div>
    </div>
  )
}
