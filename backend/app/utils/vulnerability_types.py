"""Configuration for vulnerability types metadata (icons, colors, descriptions)."""

from typing import TypedDict


class TypeMetadata(TypedDict):
    """Metadata for a vulnerability type."""

    name: str
    category: str
    icon: str  # Lucide icon name
    color: str  # Tailwind color class
    description: str


# Vulnerability types organized by category with metadata
VULNERABILITY_TYPES: dict[str, TypeMetadata] = {
    # Infrastructure & Network
    "Network": {
        "name": "Network",
        "category": "Infrastructure & Network",
        "icon": "Network",
        "color": "text-blue-600",
        "description": "Network-level vulnerabilities and misconfigurations",
    },
    "Active Directory": {
        "name": "Active Directory",
        "category": "Infrastructure & Network",
        "icon": "Building2",
        "color": "text-purple-600",
        "description": "Active Directory security issues",
    },
    "LDAP": {
        "name": "LDAP",
        "category": "Infrastructure & Network",
        "icon": "FolderTree",
        "color": "text-indigo-600",
        "description": "LDAP directory service vulnerabilities",
    },
    "DNS": {
        "name": "DNS",
        "category": "Infrastructure & Network",
        "icon": "Globe",
        "color": "text-cyan-600",
        "description": "DNS server and protocol vulnerabilities",
    },
    "Mail Server": {
        "name": "Mail Server",
        "category": "Infrastructure & Network",
        "icon": "Mail",
        "color": "text-red-600",
        "description": "Email server security issues",
    },
    "VPN": {
        "name": "VPN",
        "category": "Infrastructure & Network",
        "icon": "Shield",
        "color": "text-green-600",
        "description": "VPN configuration and protocol vulnerabilities",
    },
    "Firewall": {
        "name": "Firewall",
        "category": "Infrastructure & Network",
        "icon": "ShieldAlert",
        "color": "text-orange-600",
        "description": "Firewall misconfigurations and bypasses",
    },
    # Systems
    "Windows": {
        "name": "Windows",
        "category": "Systems",
        "icon": "Monitor",
        "color": "text-blue-500",
        "description": "Windows operating system vulnerabilities",
    },
    "Linux": {
        "name": "Linux",
        "category": "Systems",
        "icon": "Terminal",
        "color": "text-yellow-600",
        "description": "Linux/Unix system vulnerabilities",
    },
    "Unix": {
        "name": "Unix",
        "category": "Systems",
        "icon": "Server",
        "color": "text-gray-600",
        "description": "Unix system security issues",
    },
    "macOS": {
        "name": "macOS",
        "category": "Systems",
        "icon": "Laptop",
        "color": "text-gray-700",
        "description": "macOS operating system vulnerabilities",
    },
    # Web & Applications
    "Web Application": {
        "name": "Web Application",
        "category": "Web & Applications",
        "icon": "Globe2",
        "color": "text-violet-600",
        "description": "Web application security vulnerabilities",
    },
    "API": {
        "name": "API",
        "category": "Web & Applications",
        "icon": "Code2",
        "color": "text-pink-600",
        "description": "REST/GraphQL API vulnerabilities",
    },
    "Android": {
        "name": "Android",
        "category": "Web & Applications",
        "icon": "Smartphone",
        "color": "text-green-500",
        "description": "Android mobile application vulnerabilities",
    },
    "iOS": {
        "name": "iOS",
        "category": "Web & Applications",
        "icon": "Smartphone",
        "color": "text-gray-800",
        "description": "iOS mobile application vulnerabilities",
    },
    "Thick Client": {
        "name": "Thick Client",
        "category": "Web & Applications",
        "icon": "AppWindow",
        "color": "text-indigo-500",
        "description": "Desktop application vulnerabilities",
    },
    # Databases
    "Database": {
        "name": "Database",
        "category": "Databases",
        "icon": "Database",
        "color": "text-emerald-600",
        "description": "Generic database vulnerabilities",
    },
    "MS SQL Server": {
        "name": "MS SQL Server",
        "category": "Databases",
        "icon": "Database",
        "color": "text-blue-700",
        "description": "Microsoft SQL Server vulnerabilities",
    },
    "MySQL/MariaDB": {
        "name": "MySQL/MariaDB",
        "category": "Databases",
        "icon": "Database",
        "color": "text-orange-500",
        "description": "MySQL/MariaDB database vulnerabilities",
    },
    "PostgreSQL": {
        "name": "PostgreSQL",
        "category": "Databases",
        "icon": "Database",
        "color": "text-blue-600",
        "description": "PostgreSQL database vulnerabilities",
    },
    "MongoDB": {
        "name": "MongoDB",
        "category": "Databases",
        "icon": "Database",
        "color": "text-green-700",
        "description": "MongoDB NoSQL database vulnerabilities",
    },
    "Oracle": {
        "name": "Oracle",
        "category": "Databases",
        "icon": "Database",
        "color": "text-red-700",
        "description": "Oracle database vulnerabilities",
    },
    # Cloud
    "AWS": {
        "name": "AWS",
        "category": "Cloud",
        "icon": "Cloud",
        "color": "text-orange-600",
        "description": "Amazon Web Services security issues",
    },
    "Azure": {
        "name": "Azure",
        "category": "Cloud",
        "icon": "Cloud",
        "color": "text-blue-600",
        "description": "Microsoft Azure cloud vulnerabilities",
    },
    "GCP": {
        "name": "GCP",
        "category": "Cloud",
        "icon": "Cloud",
        "color": "text-yellow-500",
        "description": "Google Cloud Platform security issues",
    },
    "Cloud": {
        "name": "Cloud",
        "category": "Cloud",
        "icon": "CloudCog",
        "color": "text-sky-600",
        "description": "Generic cloud infrastructure vulnerabilities",
    },
    # Security Services
    "Authentication": {
        "name": "Authentication",
        "category": "Security Services",
        "icon": "Key",
        "color": "text-amber-600",
        "description": "Authentication mechanism vulnerabilities",
    },
    "Authorization": {
        "name": "Authorization",
        "category": "Security Services",
        "icon": "Lock",
        "color": "text-red-600",
        "description": "Authorization and access control issues",
    },
    "Cryptography": {
        "name": "Cryptography",
        "category": "Security Services",
        "icon": "ShieldCheck",
        "color": "text-purple-600",
        "description": "Cryptographic implementation vulnerabilities",
    },
    # Hardware & Embedded
    "Hardware": {
        "name": "Hardware",
        "category": "Hardware & Embedded",
        "icon": "Cpu",
        "color": "text-indigo-600",
        "description": "Hardware security vulnerabilities",
    },
    "Embedded System": {
        "name": "Embedded System",
        "category": "Hardware & Embedded",
        "icon": "Microchip",
        "color": "text-purple-700",
        "description": "Embedded system security issues",
    },
    "Firmware": {
        "name": "Firmware",
        "category": "Hardware & Embedded",
        "icon": "MemoryStick",
        "color": "text-blue-700",
        "description": "Firmware vulnerabilities and analysis",
    },
    "JTAG": {
        "name": "JTAG",
        "category": "Hardware & Embedded",
        "icon": "Cable",
        "color": "text-orange-700",
        "description": "JTAG debug interface vulnerabilities",
    },
    "UART": {
        "name": "UART",
        "category": "Hardware & Embedded",
        "icon": "Cable",
        "color": "text-yellow-700",
        "description": "UART serial communication vulnerabilities",
    },
    "SPI": {
        "name": "SPI",
        "category": "Hardware & Embedded",
        "icon": "CircuitBoard",
        "color": "text-green-700",
        "description": "SPI bus communication vulnerabilities",
    },
    "I2C": {
        "name": "I2C",
        "category": "Hardware & Embedded",
        "icon": "CircuitBoard",
        "color": "text-teal-700",
        "description": "I2C bus communication vulnerabilities",
    },
    "Bootloader": {
        "name": "Bootloader",
        "category": "Hardware & Embedded",
        "icon": "Zap",
        "color": "text-red-700",
        "description": "Bootloader security vulnerabilities",
    },
    "Secure Boot": {
        "name": "Secure Boot",
        "category": "Hardware & Embedded",
        "icon": "ShieldCheck",
        "color": "text-emerald-700",
        "description": "Secure boot bypass and weaknesses",
    },
    "Chip-Off Analysis": {
        "name": "Chip-Off Analysis",
        "category": "Hardware & Embedded",
        "icon": "Binary",
        "color": "text-slate-700",
        "description": "Physical chip extraction and analysis",
    },
    "Side-Channel Attack": {
        "name": "Side-Channel Attack",
        "category": "Hardware & Embedded",
        "icon": "Activity",
        "color": "text-pink-700",
        "description": "Power analysis, timing attacks, EM radiation",
    },
    "Fault Injection": {
        "name": "Fault Injection",
        "category": "Hardware & Embedded",
        "icon": "Zap",
        "color": "text-amber-700",
        "description": "Voltage glitching, clock manipulation attacks",
    },
    "PCB Analysis": {
        "name": "PCB Analysis",
        "category": "Hardware & Embedded",
        "icon": "Grid3x3",
        "color": "text-lime-700",
        "description": "Printed circuit board reverse engineering",
    },
    "Bluetooth Low Energy": {
        "name": "Bluetooth Low Energy",
        "category": "Hardware & Embedded",
        "icon": "Bluetooth",
        "color": "text-blue-500",
        "description": "BLE protocol and implementation vulnerabilities",
    },
    "RFID/NFC": {
        "name": "RFID/NFC",
        "category": "Hardware & Embedded",
        "icon": "Radio",
        "color": "text-violet-600",
        "description": "RFID and NFC security vulnerabilities",
    },
    "USB/HID": {
        "name": "USB/HID",
        "category": "Hardware & Embedded",
        "icon": "Usb",
        "color": "text-gray-700",
        "description": "USB and HID device vulnerabilities",
    },
    # Others
    "IoT": {
        "name": "IoT",
        "category": "Others",
        "icon": "Cpu",
        "color": "text-teal-600",
        "description": "Internet of Things device vulnerabilities",
    },
    "SCADA/ICS": {
        "name": "SCADA/ICS",
        "category": "Others",
        "icon": "Factory",
        "color": "text-slate-600",
        "description": "SCADA and Industrial Control Systems",
    },
    "Physical Security": {
        "name": "Physical Security",
        "category": "Others",
        "icon": "DoorOpen",
        "color": "text-gray-700",
        "description": "Physical access control vulnerabilities",
    },
    "Social Engineering": {
        "name": "Social Engineering",
        "category": "Others",
        "icon": "Users",
        "color": "text-rose-600",
        "description": "Social engineering attack vectors",
    },
    "Wireless": {
        "name": "Wireless",
        "category": "Others",
        "icon": "Wifi",
        "color": "text-blue-500",
        "description": "WiFi and wireless network vulnerabilities",
    },
    "VoIP": {
        "name": "VoIP",
        "category": "Others",
        "icon": "Phone",
        "color": "text-green-600",
        "description": "Voice over IP vulnerabilities",
    },
    "Container/Docker": {
        "name": "Container/Docker",
        "category": "Others",
        "icon": "Box",
        "color": "text-cyan-600",
        "description": "Container and Docker security issues",
    },
    "Kubernetes": {
        "name": "Kubernetes",
        "category": "Others",
        "icon": "Boxes",
        "color": "text-blue-700",
        "description": "Kubernetes orchestration vulnerabilities",
    },
    "CI/CD": {
        "name": "CI/CD",
        "category": "Others",
        "icon": "GitBranch",
        "color": "text-purple-500",
        "description": "CI/CD pipeline security issues",
    },
    "Configuration": {
        "name": "Configuration",
        "category": "Others",
        "icon": "Settings",
        "color": "text-gray-600",
        "description": "System and application misconfigurations",
    },
    "Other": {
        "name": "Other",
        "category": "Others",
        "icon": "HelpCircle",
        "color": "text-gray-500",
        "description": "Other vulnerability types",
    },
}


def get_type_metadata(type_name: str) -> TypeMetadata | None:
    """Get metadata for a specific vulnerability type."""
    return VULNERABILITY_TYPES.get(type_name)


def get_types_by_category() -> dict[str, list[TypeMetadata]]:
    """Get all vulnerability types organized by category."""
    result: dict[str, list[TypeMetadata]] = {}
    for metadata in VULNERABILITY_TYPES.values():
        category = metadata["category"]
        if category not in result:
            result[category] = []
        result[category].append(metadata)
    return result
